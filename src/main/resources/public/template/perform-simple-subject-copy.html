<div data-ng-controller="PerformSimpleSubjectCopyController as performSimpleSubjectCopyController">

    <!-- LOADER -->
    <div class="row" data-ng-hide="performSimpleSubjectCopyController.hasDataLoaded">
        <div class="info"><i18n>exercizer.loading</i18n></div>
    </div>

    <div data-ng-if="performSimpleSubjectCopyController.hasDataLoaded">

        <div class="row">
            <h1 class="cell">
                <span class="hover-orange" data-ng-click="performSimpleSubjectCopyController.redirectToDashboard()"><i18n>exercizer.title</i18n></span> / <span class="hover-orange" data-ng-click="">[[ performSimpleSubjectCopyController.subjectScheduled.title | limitTo: 35  ]][[ performSimpleSubjectCopyController.subjectScheduled.title.length > 35 ? '...' : '']]</span>
            </h1>

            <button class="right-magnet cell" data-ng-if="performSimpleSubjectCopyController.canHomeworkSubmit()" data-ng-click="performSimpleSubjectCopyController.openConfirmModal()">
                <i18n>exercizer.simple.submit</i18n>
            </button>

            <button class="right-magnet cell" data-ng-click="performSimpleSubjectCopyController.displayModalCopyPaste()" data-ng-if="performSimpleSubjectCopyController.previewingFromLibrary">
                <i18n>exercizer.copy.from.library</i18n>
            </button>

            <button class="right-magnet cell flat-button" data-ng-click="performSimpleSubjectCopyController.redirectToDashboard()">
                <i18n ng-if="performSimpleSubjectCopyController.previewingFromLibrary">exercizer.back.library</i18n>
                <i18n ng-if="!performSimpleSubjectCopyController.previewingFromLibrary">exercizer.back</i18n>
            </button>
        </div>

        <article class="row">
            <form name="formSubjectProperties">
                <div class="rigid-grid row">
                    <div class="twelve cell horizontal-spacing">
                        <h1>[[performSimpleSubjectCopyController.subjectScheduled.title]]</h1>
                    </div>
                    <div data-ng-if="performSimpleSubjectCopyController.canShowFuturSubmitLabel()" class="twelve cell horizontal-spacing vertical-spacing">
                        <label><strong><i18n>exercizer.future.info</i18n> [[performSimpleSubjectCopyController.subjectScheduled.begin_date | date:'dd/MM/yyyy']]</strong></label>
                    </div>
                    <div class="twelve cell horizontal-spacing vertical-spacing">
                        <h3>Consigne</h3>
                        <div style="word-wrap: break-word;" bind-html="performSimpleSubjectCopyController.subjectScheduled.description"></div>
                    </div>
                    <div class="twelve cell horizontal-spacing vertical-spacing">
                        <h3><i18n>exercizer.simple.make.label</i18n></h3>

                        <!-- DBRE template à reporter -->
                        <div data-ng-if="performSimpleSubjectCopyController.canHomeworkSubmit()"
                            class="twelve cell horizontal-spacing select-file input-block flex-row flex-center" style="margin-top:5px;margin-bottom:5px">

                            <div drop-files="performSimpleSubjectCopyController.newFiles"
                                on-drop="performSimpleSubjectCopyController.setCurrentFileName()"
                                class="droppable flex-row flex-center seven">

                                    <i ng-class="{'mail-out': !performSimpleSubjectCopyController.newFiles, 'attachment': performSimpleSubjectCopyController.newFiles}"
                                        class="horizontal-spacing medium-text"></i>

                                    <input ng-readonly="true" type="text"
                                        ng-model="performSimpleSubjectCopyController.subjectCopy.homework_metadata.filename"
                                        data-display-file
                                        class="no-margin"
                                        style="width: 100%!important; border: none;"
                                        placeholder="Glisser déposer un fichier" />
                            </div>
                            <div class="hidden-content">
                                <input type="file" style="z-index:-1" files-input-change="performSimpleSubjectCopyController.setCurrentFileName()"  ng-model="performSimpleSubjectCopyController.newFiles" />
                            </div>
                            &nbsp;&nbsp;
                            <button class="file-button flat-button no-margin"><i18n ng-if="performSimpleSubjectCopyController.canHomeworkReplace()">exercizer.simple.upload.replace</i18n><i18n ng-if="!performSimpleSubjectCopyController.canHomeworkReplace()">exercizer.simple.upload.choose</i18n></button>

                        </div>

                        <!-- DBRE template à corriger (copie rendue) -->
                        <div data-ng-if="performSimpleSubjectCopyController.canHomeworkOnlyView()"
                            class="twelve cell"
                            style="margin-top:5px;margin-bottom:5px">
                            [[performSimpleSubjectCopyController.subjectCopy.homework_metadata.filename]]
                            <span style="color:green">
                                <i18n>exercizer.simple.made.label</i18n>
                                [[performSimpleSubjectCopyController.subjectCopy.submitted_date | date:'dd/MM/yyyy']]
                            </span>
                        </div>

                        <!-- DBRE template à corriger drop-zone -->
                        <div data-ng-if="performSimpleSubjectCopyController.previewingFromLibrary" class="twelve cell horizontal-spacing select-file input-block" style="margin-top:5px;margin-bottom:5px">
                            <div>
                                <input style="width:70% !important;border:dashed" ng-readonly="true" type="text" data-display-file class="nomargin" placeholder="Glisser déposer un fichier" />
                            </div>
                            <button class="file-button flat-button" style="margin-left:20px"><i18n>exercizer.simple.upload.choose</i18n></button>
                        </div>

                    </div>
                    <div class="row horizontal-spacing vertical-spacing">
                        <div class="six cell">
                            <h3><i18n>exercizer.simple.corrected</i18n></h3>
                        </div>
                        <div class="six cell">
                            <h3><i18n>exercizer.simple.individual.corrected</i18n></h3>
                        </div>
                        <!-- todo Lauren button style -->
                        <div data-ng-if="performSimpleSubjectCopyController.canShowGeneralCorrected()" class="six cell">
                            <a data-ng-if="performSimpleSubjectCopyController.canDownloadCorrected()" data-ng-click="performSimpleSubjectCopyController.downloadGeneralCorrectedFile()" target="_blank">
                                [[performSimpleSubjectCopyController.subjectScheduled.corrected_metadata.filename]]
                                <i class="download" style="position: inherit;   bottom: 0px;  right: 0px;"></i>
                            </a>
                            <label data-ng-if="!performSimpleSubjectCopyController.canDownloadCorrected()"><i18n>exercizer.simple.consult.corrected</i18n> [[performSimpleSubjectCopyController.subjectScheduled.corrected_date | date:'dd/MM/yyyy']]</label>
                        </div>
                        <div data-ng-if="!performSimpleSubjectCopyController.canShowGeneralCorrected()" class="six cell">
                            <i18n>exercizer.simple.no.corrected</i18n>
                        </div>
                        <div data-ng-if="performSimpleSubjectCopyController.canShowIndividualCorrected()" class="six cell">
                            <a data-ng-if="performSimpleSubjectCopyController.canDownloadCorrected()" data-ng-click="performSimpleSubjectCopyController.downloadCorrectedFile()" target="_blank">
                                [[performSimpleSubjectCopyController.subjectCopy.corrected_metadata.filename]]
                                <i class="download" style="position: inherit;   bottom: 0px;  right: 0px;"></i>
                            </a>
                            <label data-ng-if="!performSimpleSubjectCopyController.canDownloadCorrected()"><i18n>exercizer.simple.consult.corrected</i18n> [[performSimpleSubjectCopyController.subjectScheduled.corrected_date | date:'dd/MM/yyyy']]</label>
                        </div>
                        <div data-ng-if="!performSimpleSubjectCopyController.canShowIndividualCorrected()" class="six cell">
                            <i18n>exercizer.simple.no.corrected</i18n>
                        </div>
                    </div>
                </div>
            </form>
        </article>

        <!-- MODAL COPY PAST -->
        <teacher-dashboard-copy-paste></teacher-dashboard-copy-paste>

        <!-- Modal confirmation -->
        <lightbox data-show="performSimpleSubjectCopyController.isModalConfirmDisplayed" on-close="performSimpleSubjectCopyController.closeConfirmModal()">
            <h2><i18n>exercizer.simple.make.label</i18n> [[performSimpleSubjectCopyController.subjectScheduled.title | limitTo: 35  ]][[ performSimpleSubjectCopyController.subjectScheduled.title.length > 35 ? '...' : '']]</h2>

            <p><i18n>exercizer.simple.make.confirm</i18n> <em>[[ performSimpleSubjectCopyController.subjectScheduled.title ]]</em> <i18n>exercizer.simple.make.confirm.to</i18n> <strong>[[ performSimpleSubjectCopyController.subjectScheduled.owner_username ]]</strong> ?</p>

            <div class="row">
                <button data-ng-click="performSimpleSubjectCopyController.saveStudentCopy()" class="cell right-magnet"><i18n>exercizer.simple.make.label</i18n></button>
                <button data-ng-click="performSimpleSubjectCopyController.closeConfirmModal()" class="cell right-magnet cancel"><i18n>exercizer.simple.make.cancel</i18n></button>
            </div>
        </lightbox>

    </div>
</div>
